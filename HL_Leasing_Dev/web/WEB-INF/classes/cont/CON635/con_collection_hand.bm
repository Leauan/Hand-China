<?xml version="1.0" encoding="UTF-8"?>
<bm:model xmlns:bm="http://www.aurora-framework.org/schema/bm" alias="t1" baseTable="con_collection_v">
    <bm:operations>
        <!-- <bm:operation name="query">
            <bm:query-sql><![CDATA[
                SELECT * FROM con_collection_v t1 #WHERE_CLAUSE#
            ]]></bm:query-sql>
        </bm:operation> -->
        <bm:operation name="update">
            <bm:update-sql><![CDATA[
            BEGIN
                -- Call the procedure
                con_persons_district_area_pkg.update_collection_hand(p_col_id => ${@col_id}, p_staff_id => ${@staff_id}, p_user_id => ${/session/@user_id});
            END;
        ]]></bm:update-sql>
        </bm:operation>
    </bm:operations>
    <bm:fields>
        <bm:field name="col_id"/>
        <bm:field name="contract_number"/>
        <bm:field name="project_number"/>
        <bm:field name="bp_name"/>
        <bm:field name="staff_name"/>
        <bm:field name="overdue_status_type_n"/>
        <bm:field name="remain_principal"/>
        <bm:field name="overdue_amount_sum"/>
        <bm:field name="overdue_max_days"/>
        <bm:field name="province_description" expression="(SELECT fp.description   FROM con_contract    t,        con_contract_bp cc,        hls_bp_master   t2,        fnd_province    fp  WHERE t.contract_id = cc.contract_id    AND cc.bp_id = t2.bp_id    AND t2.bp_type = &apos;AGENT&apos;    AND t.data_class = &apos;NORMAL&apos;    AND t2.work_province = fp.province_id    AND t.contract_id = t1.contract_id)"/>
    </bm:fields>
    <bm:query-fields>
        <bm:query-field name="contract_number" queryExpression="t1.contract_number like  &apos;%&apos; || ${@contract_number} || &apos;%&apos;"/>
        <bm:query-field name="project_number" queryExpression="t1.project_number like  &apos;%&apos; || ${@project_number} || &apos;%&apos;"/>
        <bm:query-field name="bp_name" queryExpression="t1.bp_name like  &apos;%&apos; || ${@bp_name} || &apos;%&apos;"/>
        <bm:query-field name="bp_phone" queryExpression="t1.bp_phone like  &apos;%&apos; || ${@bp_phone} || &apos;%&apos;"/>
        <bm:query-field name="license_number" queryExpression="t1.license_number like  &apos;%&apos; || ${@license_number} || &apos;%&apos;"/>
        <bm:query-field name="staff_id" queryExpression="t1.staff_id = ${@staff_id}"/>
        <bm:query-field name="overdue_status" queryExpression="t1.overdue_status = ${@overdue_status}"/>
        <bm:query-field name="province" queryExpression="t1.province like  &apos;%&apos; || ${@province} || &apos;%&apos;"/>
        <bm:query-field name="creation_date" queryExpression="t1.creation_date = to_date(${@creation_date},&apos;yyyy-mm-dd&apos;)"/>
    </bm:query-fields>
    <bm:data-filters>
        <bm:data-filter enforceOperations="query" expression="t1.data_class =&apos;NORMAL&apos;"/>
    </bm:data-filters>
</bm:model>
