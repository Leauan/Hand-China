<?xml version="1.0" encoding="UTF-8"?>
<bm:model xmlns:bm="http://www.aurora-framework.org/schema/bm">
    <bm:operations>
        <bm:operation name="query">
            <bm:query-sql><![CDATA[
                SELECT
                    COUNT(1) count_car,
                    SUM(t1.due_amount) due_amount,
                    SUM(t1.received_amount) received_amount,
                    SUM(t1.unreceived_amount) unreceived_amount
                FROM
                    (SELECT
                        li.item_frame_number ,
                        SUM(cf.due_amount) due_amount,
                        SUM(nvl(cf.received_amount,0)) received_amount,
                        SUM(cf.due_amount -nvl(cf.received_amount,0)) unreceived_amount
                    FROM
                        con_contract_df_car_info li,
                        con_contract cc,
                        con_contract_cashflow cf #WHERE_CLAUSE#
                    GROUP BY
                        li.item_frame_number
                    ) t1
            ]]></bm:query-sql>
        </bm:operation>
    </bm:operations>
    <bm:query-fields>
        <bm:query-field name="month" queryExpression="to_char(cf.due_date,&apos;YYYYMM&apos;)=${@month}"/>
        <bm:query-field name="car_status_desc" queryExpression="li.car_status=${@car_status}"/>
        <bm:query-field name="contract_status_flag" queryExpression="decode(cc.contract_status,&apos;REDEMPTED&apos;,&apos;Y&apos;,&apos;N&apos;)=${@contract_status_flag}"/>
    </bm:query-fields>
    <bm:data-filters>
        <bm:data-filter expression="li.contract_id = cc.contract_id    and cf.contract_id = cc.contract_id    and cf.cf_status = &apos;RELEASE&apos;    and cf.cf_item = 301    and cc.data_class = &apos;NORMAL&apos;    and cc.lease_channel = &apos;01&apos; and cc.bp_id_tenant =(select bp_id from sys_user where user_id=${/session/@user_id})"/>
    </bm:data-filters>
</bm:model>
