<?xml version="1.0" encoding="UTF-8"?>
<!--
    $Author: Yenick  
    $Date: 2018-04-26
    $Revision: 1.0  
    $Purpose:宏菱sbo接口_查询返回数据，一次性发送
-->
<a:service xmlns:p="uncertain.proc" xmlns:a="http://www.aurora-framework.org/application" xmlns:s="aurora.plugin.script" trace="true">
    <a:init-procedure>
        <s:server-script><![CDATA[
            importPackage(java.io);
            importPackage(Packages.org.tempuri);
            var xml_bm = $bm('sbo_inf.hls_sbo_splice_xml');
            var xml_batch_splice_bm = $bm('sbo_inf.hl_transport_xml');
            var xml_results = xml_bm.queryAsMap().getChildren();
            // var xml = xml_result[0].request_query_xml;
            // var resquest_new_number=xml_result[0].resquest_new_number;
            if (xml_result) {
                for (var i = 0;i < xml_result.length;i++) {
                    var xml_result = xml_results[i];
                    try {
                        var response_xml = new WebserviceSoapStub.JEDocuments(xml_result.request_query_xml);
                        xml_batch_splice_bm.update({
                            "result_xml": response_xml,
                            "resquest_id": xml_result.resquest_new_number
                        });
                    }
                } catch (e) {
                    println("错误信息" + e);
                }
            
            }
        ]]></s:server-script>
    </a:init-procedure>
</a:service>
