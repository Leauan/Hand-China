<?xml version="1.0" encoding="UTF-8"?>
<a:screen xmlns:a="http://www.aurora-framework.org/application">
    <a:view>
        <a:link id="hls_acr_vat_upload_link" url="${/request/@context_path}/modules/acr/ACR515/hls_acr_vat_import_upload.screen"/>
        <a:link id="hls_acr_vat_trans_upload_link" url="${/request/@context_path}/modules/acr/ACR515/hls_acr_vat_import_trans_upload.screen"/>
        <a:link id="hls_acr_vat_import_shw_err_link" url="${/request/@context_path}/modules/acr/ACR515/hls_acr_vat_import_showerrors.screen"/>
        <a:link id="acr515_check_import_link" model="acr.ACR515.check_vat_tmp" modelaction="execute"/>
        <a:link id="acr515_confirm_import_link" model="acr.ACR515.hls_vat_confirm" modelaction="execute"/>
        <script><![CDATA[
            //$('submitbtn').disable();
            
            function importbtn() {
                new Aurora.Window({
                    id: 'upload_window',
                    url: $('hls_acr_vat_upload_link').getUrl()+'?kind=${/parameter/@kind}',
                    prompt: '${l:PROMPT.LOADDATA}',
                    width: 420,
                    height: 280
                });
            }
            
            function checkbtn() {
                Aurora.request({
                    url: $('acr515_check_import_link').getUrl(),
                    success: function(args) {
                        $('submitbtn_id').enable();
                    },
                    scopr: this
                });
            }
            
            function submitbtn() {
                var detail_mask = Ext.getBody();
                Aurora.Masker.mask(detail_mask, '${l:HLS.EXECUTING}');
                Aurora.request({
                    url: $('acr515_confirm_import_link').getUrl(),
                    success: function(args) {
                        Aurora.showMessage('提示信息', '操作成功', $('import_data_ds').query());
                        Aurora.Masker.unmask(detail_mask, '${l:HLS.EXECUTING}');
                    },
                    failure: function() {
                        Aurora.Masker.unmask(detail_mask, '${l:HLS.EXECUTING}');
                    },
                    error: function() {
                        Aurora.Masker.unmask(detail_mask, '${l:HLS.EXECUTING}');
                    }
                });
            }
            
            function showerrorbtn() {
                new Aurora.Window({
                    id: 'show_error_window',
                    url: $('hls_acr_vat_import_shw_err_link').getUrl(),
                    prompt: '错误数据',
                    width: 900,
                    height: 470
                });
            }
        ]]></script>
        <a:dataSets>
            <a:dataSet id="import_data_ds" autoQuery="true" fetchAll="true" model="acr.ACR515.hls_vat_import_tmp"/>
        </a:dataSets>
        <a:screenBody>
            <a:hBox>
                <a:button click="importbtn" text="导入"/>
                <a:button click="checkbtn" text="校验"/>
                <a:button id="submitbtn_id" click="submitbtn" text="确定"/>
                <a:button click="showerrorbtn" text="显示错误信息"/>
            </a:hBox>
            <a:grid bindTarget="import_data_ds" height="500" marginWidth="30">
                <a:columns>
                    <a:column name="segment1" prompt="作废标志" width="150"/>
                    <a:column name="segment2" prompt="发票种类" width="150"/>
                    <a:column name="vat_doc_number" prompt="单据号" width="150"/>
                    <a:column name="vat_code" prompt="发票代码" width="150"/>
                    <a:column name="vat_number" prompt="发票号码" width="150"/>
                    <a:column name="segment3" prompt="客户编号" width="150"/>
                    <a:column name="segment4" prompt="客户名称" width="150"/>
                    <a:column name="segment5" prompt="客户税号" width="150"/>
                    <a:column name="segment6" prompt="客户地址电话" width="150"/>
                    <a:column name="segment7" prompt="客户银行及帐号" width="150"/>
                    <a:column name="vat_date_str" prompt="开票日期" width="150"/>
                    <a:column name="segment8" prompt="备注" width="150"/>
                    <a:column name="segment9" prompt="开票人" width="150"/>
                    <a:column name="segment10" prompt="收款人" width="150"/>
                    <a:column name="segment11" prompt="复核人" width="150"/>
                    <a:column name="segment12" prompt="销方银行及帐号" width="150"/>
                    <a:column name="segment13" prompt="销方地址电话" width="150"/>
                    <a:column name="segment14" prompt="商品编号" width="150"/>
                    <a:column name="segment15" prompt="商品名称" width="150"/>
                    <a:column name="segment16" prompt="规格型号" width="150"/>
                    <a:column name="segment17" prompt="计量单位" width="150"/>
                    <a:column name="segment18" prompt="数量" width="150"/>
                    <a:column name="segment19" prompt="金额（含税）" width="150"/>
                    <a:column name="segment20" prompt="税率" width="150"/>
                    <a:column name="segment21" prompt="税额" width="150"/>
                    <a:column name="segment22" prompt="收货人" width="150"/>
                    <a:column name="segment23" prompt="收货人纳税人识别号" width="150"/>
                    <a:column name="segment24" prompt="发货人" width="150"/>
                    <a:column name="segment25" prompt="发货人纳税人识别号" width="150"/>
                    <a:column name="segment26" prompt="起运地、经由、到达地" width="150"/>
                    <a:column name="segment27" prompt="车种车号" width="150"/>
                    <a:column name="segment28" prompt="车船吨位" width="150"/>
                    <a:column name="segment29" prompt="运输货物信息" width="150"/>
                    <a:column name="segment30" prompt="编码版本号" width="150"/>
                    <a:column name="segment31" prompt="税收分类编码" width="150"/>
                    <a:column name="segment32" prompt="是否享受优惠政策" width="150"/>
                    <a:column name="segment33" prompt="享受税收优惠政策内容" width="150"/>
                    <a:column name="segment34" prompt="零税率标识" width="150"/>
                    <a:column name="segment35" prompt="扣除额" width="150"/>
                </a:columns>
            </a:grid>
        </a:screenBody>
        <script><![CDATA[
        	$('submitbtn_id').disable();
        ]]></script>
    </a:view>
</a:screen>
