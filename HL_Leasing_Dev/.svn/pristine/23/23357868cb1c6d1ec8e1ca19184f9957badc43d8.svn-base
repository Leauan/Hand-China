<?xml version="1.0" encoding="UTF-8"?>
<a:service xmlns:task="aurora.application.task" xmlns:s="aurora.plugin.script" xmlns:dr="aurora.plugin.excelreport" xmlns:mail="aurora.plugin.mail" xmlns:msg="aurora.application.features.msg" xmlns:t="uncertain.composite.transform" xmlns:p="uncertain.proc" xmlns:a="http://www.aurora-framework.org/application" xmlns:excel="aurora.application.task.excel" trace="true">
    <a:init-procedure>
        <!--数据DS-->
        <a:model-execute model="acr.ACR528.insert_atm" rootPath="atm_mulit_id"/>
        <p:set field="/model/basic_data" setToNull="true"/>
        <a:model-query fetchAll="true" model="acr.ACR528.acr_invoice_excel" rootPath="/model/basic_data"/>
        <p:echo/>
        <dr:excel-report enableTask="true" filename="${/model/basic_data/record/@file_name}.xlsx" template="${/request/@context_path/autocrud}/u01/hls/template/acr_invoice_excel.xlsx">
            <dr:sheets>
                <dr:sheet name="发票导出" displayGridlines="false">
                    <dr:static-content>
                        <dr:cell-data cell="B" row="2" type="content" value="${/model/basic_data/record/@year}"/>
                        <dr:cell-data cell="D" row="2" type="content" value="${/model/basic_data/record/@month}"/>
                        <dr:cell-data cell="F" row="2" type="content" value="${/model/basic_data/record/@day}"/>
                        <dr:cell-data cell="A" row="4" type="content" value="${/model/basic_data/record/@contract_name}"/>
                        <dr:cell-data cell="A" row="5" type="content" value="${/model/basic_data/record/@upper_principal}"/>
                        <dr:cell-data cell="A" row="6" type="content" value="${/model/basic_data/record/@ren_principal_n}"/>
                        <dr:cell-data cell="H" row="5" type="content" value="${/model/basic_data/record/@principal}"/>
                    </dr:static-content>
                </dr:sheet>
            </dr:sheets>
        </dr:excel-report>
        <a:model-insert model="acr.ACR528.insert_atm"/>
        <p:echo/>
    </a:init-procedure>
    <a:service-output output="/parameter"/>
</a:service>
