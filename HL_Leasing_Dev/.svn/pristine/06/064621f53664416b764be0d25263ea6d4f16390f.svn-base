<?xml version="1.0" encoding="UTF-8"?>
<a:screen xmlns:a="http://www.aurora-framework.org/application" customizationEnabled="true" trace="true">
    <a:init-procedure/>
    <a:view>
        <script type="text/javascript"><![CDATA[
		]]></script>
        <OBJECT id="WebOffice1" classid="clsid:E77E049B-23FC-4DB8-B756-60529A35FAD5" height="100%" style="LEFT: 0px; TOP: 0px" width="100%">
            <PARAM NAME="_Version" VALUE="65536"/>
            <PARAM NAME="_ExtentX" VALUE="2646"/>
            <PARAM NAME="_ExtentY" VALUE="16323"/>
            <PARAM NAME="_StockProps" VALUE="0"/>
        </OBJECT>
        <!--触发初始化方法-->
        <SCRIPT EVENT="NotifyCtrlReady" FOR="WebOffice1" LANGUAGE="javascript"><![CDATA[
			 	WebOffice1_NotifyCtrlReady();
			]]></SCRIPT>
        <script type="text/javascript"><![CDATA[
				//执行初始化方法，打开新文档或装载已经存在的文档
				function WebOffice1_NotifyCtrlReady() {
					var openUrl = '/weboffice_download_file.svc?file_name=' + encodeURIComponent('weboffice.doc') + '&file_path=' + encodeURIComponent('C:\\weboffice.doc');
					 
				     document.all.WebOffice1.LoadOriginalFile(openUrl, "doc");
					// document.all.WebOffice1.ProtectDoc(1, 2, "12345");	
					
					var obj;debugger;
					 obj = new Object(document.all.WebOffice1.GetDocumentObject());
					 if(obj !=null){
					   var pBookMarks;
						// VAB接口获取书签集合
					   pBookMarks = obj.Bookmarks;
					}
				} 
				
			function SaveServerFile() { 			   
			   var saveUrl = '/file_upload.svc?file_name=' + encodeURIComponent('weboffice.doc') + '&file_path=' + encodeURIComponent('C:\\weboffice.doc');
			   var Object=document.all.WebOffice1;
				//Object.OptionFlag |= 0x0080;
			//	Object.OptionFlag &= 0xff7f;//默认不显示进度条
				Object.HttpInit(); //初始化HTTP引擎。
				//Object.HttpAddPostString("NAME",'weboffice.doc'); //设置上传文件名。
				//Object.HttpAddPostString("FTYPE","doc"); //设置上传文件类型。
				Object.HttpAddPostCurrFile("FileBlod","");//设置上传当前文件,文件标识为FileBlod。
				var returnStr=Object.HttpPost(saveUrl);debugger;
				var returnJson = JSON.parse(returnStr);
				var success = returnJson.success;
				if(success){
					//Aurora.showMessage('提示', '保存成功');
					//Aurora.SideBar.show({
					//	msg: '保存成功',
					//	duration: 2000
					//});
					alert('保存成功');
				}else{
					//Aurora.showMessage('提示', '保存失败');
					//Aurora.SideBar.show({
					//	msg: '保存失败',
					//	duration: 2000
					//});
					alert('保存失败');
				}
            }
			]]></script>
        <a:screenTopToolbar>
            <a:screenTitle/>
            <a:gridButton click="SaveServerFile" text="保存-点聚"/>
        </a:screenTopToolbar>
    </a:view>
</a:screen>
