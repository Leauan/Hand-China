<?xml version="1.0" encoding="UTF-8"?>
<!--
    $Author: qwm  
    $Date: 2013-5-22 上午11:10:19  
    $Revision: 1.0  
    $Purpose: 
-->
<a:screen xmlns:a="http://www.aurora-framework.org/application" dynamiccreateenabled="true" trace="true">
    <a:init-procedure/>
    <a:view>
        <a:link id="deposit_return_print_link" url="${/request/@context_path}/modules/csh/CSH542/deposit_return_doc_print.screen"/>
        <div/>
        <script><![CDATA[
        function check_data(records) {
                for (var i = 0;i < records.length;i++) {
                    if (records[i].get('approval_status') === 'APPROVED') {
                        continue;
                    } else {
                        return false;
                    }
                }
                return true;
            }
        
    	window['${/parameter/@layout_code}_user_button1_layout_dynamic_click'] = function() {
        	var ds_id = get_dsid_by_basetable(window['${/parameter/@layout_code}_layoutDataSetList'], 'csh_transaction_return');
        	var records = $(ds_id).getSelected();
                if (records.length === 0) {
                    Aurora.showMessage('${l:PROMPT}', '请选择至少一条记录');
                    return;
                }
                 // else if (!check_data(records)) {
                    // Aurora.showWarningMessage('提示', '仅能打印汇签单列显示为<font color="red">未打印</font>或已打印的数据！');
                    // return;
                // }
                var instr = '';
                for (var i = 0;i < records.length;i++) {
                    if (i == 0) {
                        instr = instr + records[i].get('return_id');
                    } else {
                        instr = instr + ',' + records[i].get('return_id');
                    }
                }
                var url = $('deposit_return_print_link').getUrl() + '?return_id=' + instr;
                window.open(url);
    	};            

        ]]></script>
        <a:screen-include screen="modules/cont/CON500/con_contract_get_layout_code.screen"/>
    </a:view>
</a:screen>
