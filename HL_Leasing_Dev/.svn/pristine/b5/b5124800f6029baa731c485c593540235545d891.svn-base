<?xml version="1.0" encoding="UTF-8"?>
<!--
    $Author: zhangxing5129  
    $Date: 2014-8-29 下午03:53:38  
    $Revision: 1.0  
    $Purpose: 商业伙伴创建   入口界面
-->
<a:screen xmlns:a="http://www.aurora-framework.org/application" customizationEnabled="true" dynamiccreateenabled="true" trace="true">
    <a:view>
        <a:link id="hls_bp_master_link" url="${/request/@context_path}/modules/hls/HLS213N/hls_bp_master_create.screen"/>
        <a:link id="get_layout_code_link_id" model="cont.CON500.con_contract_get_layout_code" modelaction="update"/>
        <script><![CDATA[
            window['${/parameter/@layout_code}_user_button1_layout_dynamic_click'] = function() {
                debugger;
                var ds_id = get_dsid_by_basetable(window['${/parameter/@layout_code}_layoutDataSetList'], 'hls_bp_master');
                var record = $(ds_id).getCurrentRecord();
                if ($(ds_id).validate()) {
                    record.set('function_code', 'HLS213D');
                    record.set('function_usage', 'CREATE');
                    record.set('default_value_dsid', ds_id);
                    record.data['url_title'] = '商业伙伴创建';
                    var param = record.data;
                    hls_doc_get_layout_code('get_layout_code_link_id', param, 'hls_bp_master_link', null, '${/parameter/@layout_code}');
                }
            };
            //更新时调用
            window['${/parameter/@bp_seq}${/parameter/@layout_code}_on_layout_dynamic_update'] = function(ds, record, name, value, old_value, bp_seq){
                var f_bp_create_ds_id = get_dsid_by_basetable(window['${/parameter/@layout_code}_layoutDataSetList'], 'hls_bp_master');
                if(f_bp_create_ds_id==ds.id){
                    if(name=='bp_type'){
                        if(value=='AGENT' || value=='GUTA_ORG' || value=='VENDER'){
                            record.set('bp_class','ORG');
                            record.set('bp_class_n','企业');
                            record.getField('bp_class_n').setReadOnly(true);
                        }
                        else if(value=='GUTA_NP'){
                            record.set('bp_class','NP');
                            record.set('bp_class_n','个人');
                            record.getField('bp_class_n').setReadOnly(true);
                        }
                        else if(value=='TENANT'){
                            record.getField('bp_class_n').setReadOnly(false);
                        }
                    }
                }
            };
        ]]></script>
        <a:screen-include screen="modules/cont/CON500/con_contract_get_layout_code.screen"/>
    </a:view>
</a:screen>
