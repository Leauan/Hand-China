<?xml version="1.0" encoding="UTF-8"?>
<!--
    $Author: 苗苗  
    $Date: 2018-12-21 上午10:43:02  
    $Revision: 1.0  
    $Purpose: 
-->
<bm:model xmlns:bm="http://www.aurora-framework.org/schema/bm">
    <bm:operations>
        <bm:operation name="query">
            <bm:query-sql><![CDATA[
               SELECT
                    t1.*
                FROM
                    (SELECT
                        p.project_id,
                        p.lease_start_date,
                        p.project_number,
                        p.business_type,
                        p.bp_id_tenant,
                        t.bp_id,
                        t.finance_amount,
                        p.project_status,                       
                       (case when p.project_status in ('APPROVING','APPROVED') then t.finance_amount else 0 end)as rm_amount,
                       (case  when p.project_status not in ('APPROVING','APPROVED') then t.finance_amount else 0 end  )as rp_amount
                    FROM
                        prj_project p,
                        prj_project_df_info_lv t
                    WHERE
                       p.project_id=t.project_id
                       t.bp_id = ${@bp_id}
                    ) t1
            ]]></bm:query-sql>
        </bm:operation>
    </bm:operations>
    <bm:fields>
        <bm:field name="project_id" databaseType="NUMBER" datatype="java.lang.Long" physicalName="PROJECT_ID"/>
        <bm:field name="project_number" databaseType="VARCHAR2" datatype="java.lang.Long" physicalName="PROJECT_NUMBER"/>
        <bm:field name="business_type" databaseType="VARCHAR2" datatype="java.lang.Long" physicalName="BUSINESS_TYPE"/>
        <bm:field name="finance_amount" databaseType="VARCHAR2" datatype="java.lang.Long" physicalName="FINANCE_AMOUNT"/>
        <bm:field name="project_status" databaseType="VARCHAR2" datatype="java.lang.Long" physicalName="BUSINESS_TYPE"/>
        <bm:field name="last_start_date" databaseType="DATE" datatype="java.lang.Long" physicalName="LAST_START_DATE"/>
        <bm:field name="rm_amount"/>
        <bm:field name="rp_amount"/>
    </bm:fields>
</bm:model>
