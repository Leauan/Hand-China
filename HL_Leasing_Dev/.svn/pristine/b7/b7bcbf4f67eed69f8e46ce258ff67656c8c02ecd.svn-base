<?xml version="1.0" encoding="UTF-8"?>
<a:screen xmlns:a="http://www.aurora-framework.org/application">
    <a:init-procedure/>
    <a:view>
        <a:link id="prj501df_attach_downloadfile_link" url="${/request/@context_path}/downloadFile.screen"/>
        <a:link id="prj501df_attach_uploadfile_link" url="${/request/@context_path}/uploadFile.screen"/>
        <script><![CDATA[
        	function saveClick(){
        		if (document.getElementById('importFile').value){
        			var fileName = document.getElementById('importFile').value;
        			var fileType = fileName.substr(fileName.lastIndexOf("."));
        			if (fileType != '.xls'&&fileType != '.xlsx'){
        				alert('${l:SELECT_CORRECT_IMPORT_FILE}');
        			} else {
        				document.getElementById('importForm').submit();
        			}
        		}
        	}
        	
        	function downloadTemp(){
        	    var company_id = '${/session/@company_id}';
        	    var url = '';
        	    //管理员可上传模板
        	    if('${/session/@role_id}' == 1){
        	        url = $('prj501df_attach_uploadfile_link').getUrl();
        	    }else{
        	        url = $('prj501df_attach_downloadfile_link').getUrl();
        	    }
        	    url = url + '?table_name=PRJ_PROJECT_DF_TEMPLET&header_id=' + company_id; //以公司id作为主键
                var win = new Aurora.Window({
                    url: url,
                    title: '${l:HLS201.HLS_LEASE_ITEM_LIST_TPLT_IPT}',
                    id: 'prj501df_attach_downloadfile_window',
                    width: 850,
                    height: 400
                });
                win.on('close', function() {
                });
        	}
        	
    	]]></script>
        <a:dataSets>
            <a:dataSet id="label_ds" autoCreate="true">
                <a:fields>
                    <a:field name="label2" defaultValue="${l:STRICT_IMPORTED_TEMPLATE_DATA}"/>
                    <a:field name="label3" defaultValue="${l:PRODUCT_MASTER_DATA_IMPORT}"/>
                    <a:field name="label4" defaultValue="${l:IMPORTER_ONLY_SUPPORTS}"/>
                    <a:field name="label5" defaultValue="${l:READ_THE_ABOVE_CAREFULLY}"/>
                    <a:field name="label6" defaultValue="${l:THE_IMPORT_IS_COMPLETE}"/>
                </a:fields>
            </a:dataSet>
        </a:dataSets>
        <a:fieldSet style="margin-left:10px;margin-top:10px;" title="IMPORT_CONSIDERATIONS" width="400">
            <a:label name="label2" bindTarget="label_ds" style="margin-left:10px;" width="380"/>
            <a:label name="label3" bindTarget="label_ds" style="margin-left:10px;" width="380"/>
            <a:label name="label4" bindTarget="label_ds" style="margin-left:10px;" width="380"/>
            <a:label name="label5" bindTarget="label_ds" style="color:#055A78;font-weight:bold;margin-left:10px;" width="380"/>
            <a:box column="2" row="1" style="margin-left:-3px;">
                <a:label name="label6" bindTarget="label_ds" style="color:#055A78;font-weight:bold;margin-left:10px;" width="266"/>
                <input onclick="downloadTemp()" style="width:64px;" type="button" value="模板下载"/>
            </a:box>
        </a:fieldSet>
        <a:fieldSet style="margin-left:10px;margin-top:10px;" title="TMPLT_IMPORT_FILE" width="400">
            <form name="upload" id="importForm" action="${/request/@context_path}/modules/prj/PRJ501DF/prj_car_import_upload_info.screen" enctype="multipart/form-data" method="post">
                <label style="margin-left:10px;margin-top:10px"><![CDATA[${l:PLEASE_SELECT_A_FILE}]]></label>
                <input name="CONTENT" id="importFile" style="margin-bottom:4px;width:160px;height:22px;" type="file"/>
                <input onclick="saveClick()" style="margin-left:50px;margin-top:10px;width:60px;" type="button" value="导入"/>
            </form>
        </a:fieldSet>
    </a:view>
</a:screen>
