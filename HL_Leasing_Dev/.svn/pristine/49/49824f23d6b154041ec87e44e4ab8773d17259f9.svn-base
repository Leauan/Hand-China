<?xml version="1.0" encoding="UTF-8"?>
<a:screen xmlns:a="http://www.aurora-framework.org/application" customizationEnabled="true" dynamiccreateenabled="true" trace="true">
    <a:view>
        <a:link id="con_contract_move_cars_select_wfl_link" url="${/request/@context_path}/modules/cont/CON652/con_contract_move_cars_select_wfl.screen"/>
        <script><![CDATA[

           //批量录入库点信息并确认
           window['${/parameter/@layout_code}_user_button1_layout_dynamic_click'] = function() {
               var ds_id = get_dsid_by_basetable(window['${/parameter/@layout_code}_layoutDataSetList'], 'con_move_cars_ln'); 
               var records = $(ds_id).getSelected(); 
               if (records.length < 1) {
                   Aurora.showInfoMessage('', '请选择一条', null, 250, 100);
                   return;
               }
               var param = {};
               var win = new Aurora.Window({
                   id: 'con_contract_move_cars_select_winid',
                   url: $('con_contract_move_cars_select_wfl_link').getUrl(),
                   params: {
                       winId: 'con_contract_move_cars_select_winid',
                       pre_layout_code: '${/parameter/@layout_code}',
                       pre_function_code: '${/parameter/@function_code}',
                       function_code: 'CON652R',
                       function_usage: 'MODIFY'
                   },
                   title: '选择移库',
                   width: 340,
                   height: 150
               });
               win.on('close',function(){
                   $(ds_id).query();
               });
           };

           // 更新事件
            window['${/parameter/@bp_seq}${/parameter/@layout_code}_on_layout_dynamic_update'] = function(ds, record, name, value, old_value, bp_seq) {
                if(name == 'inventory_address_level' && value){
                    if(value == 'EXHIBITION'){
                        record.getField('remove_date').setRequired(true);
                    }else{
                        record.getField('remove_date').setRequired(false);
                    }
                }

            };

            function zjwfl_get_params() {
                var params = {
                    layout_code: '${/parameter/@layout_code}',
                    function_usage: '${/parameter/@function_usage}',
                    function_code: '${/parameter/@function_code}'
                };
                return params;
            }


        ]]></script>
         <a:screen-include screen="modules/cont/CON500/con_contract_get_layout_code.screen"/>
    </a:view>
</a:screen>
