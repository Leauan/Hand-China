<?xml version="1.0" encoding="UTF-8"?>
<a:screen xmlns:a="http://www.aurora-framework.org/application" customizationEnabled="true" dynamiccreateenabled="true" trace="true">
    <a:view>
        <script><![CDATA[
          
            window['${/parameter/@layout_code}_on_layout_dynamic_grid_query'] = function(ds, qpara, bp_seq) {
                var ds_id = get_dsid_by_basetable(window['${/parameter/@layout_code}_layoutDataSetList'], 'con_contract');
            
                if (ds == $(ds_id)) {
                    aut_authority_list_validate_query(ds, qpara);
            
                }
            };
            //加载时调用(grid,table,gridBox)
            
            // window['${/parameter/@layout_code}_on_layout_dynamic_grid_query'] = function(ds, qpara, bp_seq) {
               // alert( '${/parameter/@bp_id}');
                // qpara['bp_id'] = '${/parameter/@bp_id}';
               
            // };
             window['${/parameter/@layout_code}_on_layout_dynamic_update'] = function(ds, record, name, value, old_value, bp_seq) {
             var ds_id = get_dsid_by_basetable(window['${/parameter/@layout_code}_layoutDataSetList'], 'hl_rate_linkage');
                 
             };
             
             
  window['${/parameter/@bp_seq}${/parameter/@layout_code}_on_layout_dynamic_before_submit'] = function(ds, record) {                window['${/parameter/@layout_code}_unlock_layout_dynamic_window']();
                 var ds_ids = get_dsid_by_basetable(window['${/parameter/@layout_code}_layoutDataSetList'], 'hl_rate_linkage');
                   ds_id = $(ds_ids);
                records=ds_id.getAll();
                debugger;
                for(var i=0;i<records.length;i++){
                    if(records[i].get('residual_preferential_limit')>0){
                        continue;
                    }
                    records[i].set('residual_preferential_limit', records[i].get('preferential_amount'));
                }
            };
        ]]></script>
    </a:view>
</a:screen>
