<?xml version="1.0" encoding="UTF-8"?>
<a:screen xmlns:a="http://www.aurora-framework.org/application" cache="false" default-dispatch="${/model/url/@URL}" dispatch-style="redirect" trace="true">
    <a:init-procedure>
        <a:model-query model="csh.CSH502.csh_payment_req_query_for_print" rootPath="payment_req_path"/>
        <a:model-query model="csh.CSH502.csh_payment_req_ln_upd_query" rootPath="payment_req_ln_path"/>
        <a:model-query model="csh.CSH502.csh_payment_req_approved" rootPath="approved_info_path"/>
        <a:model-execute model="csh.CSH502.update_csh_payment_req_hd_print"/>
    </a:init-procedure>
    <a:view>
        <style media="print"><![CDATA[
	        .PageNext
	        {
	            page-break-after: always;
	        }
		]]></style>
        <style type="text/css"><![CDATA[
			table
			{
			border-collapse:collapse;
			border:none;
			};
			td{
			    height:50px;
			}
    	]]></style>
        <ajax-init/>
        <a:freeMarker><![CDATA[
        <#if  model.getObject('/model/payment_req_path').getChilds()??>
		<#list  model.getObject("/model/payment_req_path").getChilds() as payment_req_rec>
		 <#if (payment_req_rec.getString('rk')!'')!='1'> 
		    <div class="PageNext">
            </div>
         </#if>
		 <P align="center">
            <B>
                <FONT face="楷体" size="7" style="border-bottom:4px double black;">付款申请单</FONT>
                <br/>
            </B>
        </P>
       <table border="1" width="1000"  style="margin-left:80px;"  >
            <tr>
             <td width="10%">合同编号</td>
             <td width="15%">${payment_req_rec.getString('contract_number')!''}</td> 
             <td width="10%">车架号</td>
             <td width="15%">${payment_req_rec.getString('item_frame_number')!''}</td> 
             <td width="10%">申请日期</td>
             <td width="15%">${payment_req_rec.getString('approval_date')!''}</td> 
             <td width="10%">币种</td>
             <td width="15%">人民币</td>  
           </tr>
		    <tr>
             <td >对象名称</td>
             <td colspan="3">${payment_req_rec.getString('bp_name')!''}</td> 
             <td >承租人</td>
             <td colspan="3">${payment_req_rec.getString('tenant_name')!''}</td> 
           </tr>
      </table>
      <p/>
      <table border="1" width="1000"  style="margin-left:80px;">
         <tr>
           <td width="20%" style="text-align:center;">应付项目</td>
           <td width="12%" style="text-align:center;">本次申请金额</td>
           <td width="12%" style="text-align:center;">实际发票金额</td>
           <td width="12%" style="text-align:center;">预估金额</td>
           <td width="10%" style="text-align:center;">申请付款日期</td>
           <td width="12%" style="text-align:center;">应付金额</td>
           <td width="10%" style="text-align:center;">计划付款日期</td>
           <td width="12%" style="text-align:center;">未付款金额</td>
         </tr>
             <#if  model.getObject('/model/payment_req_ln_path').getChilds()??>
		     <#list  model.getObject("/model/payment_req_ln_path").getChilds() as payment_req_l_rec>
		     <#if (payment_req_rec.getString('payment_req_id'))==(payment_req_l_rec.getString('payment_req_id'))> 
		       <tr>
		       <td>${payment_req_l_rec.getString('cf_description')!''}</td>
		       <td style="text-align:right;">${payment_req_l_rec.getString('amount')!''}</td>
		       <td style="text-align:right;">${payment_req_l_rec.getString('virtual_amount')!''}</td>
		       <td style="text-align:right;">${payment_req_l_rec.getString('estimated_due_amount')!''}</td>
		       <td style="text-align:center;">${payment_req_l_rec.getString('apply_pay_date')!''}</td>
		       <td style="text-align:right;">${payment_req_l_rec.getString('due_amount')!''}</td>
		       <td style="text-align:center;">${payment_req_l_rec.getString('due_date')!''}</td>
		       <td style="text-align:right;">${payment_req_l_rec.getString('residual_amount')!''}</td>
		       </tr>
		      </#if>
		     </#list>
		     </#if>
		     </table>
		     <p/>
		     <table border="1" width="1000"  style="margin-left:80px;">
		    <tr>
		       <td width="20%" style="text-align:center;">审批时间</td>
               <td width="10%" style="text-align:center;">审批操作</td>
               <td width="35%" style="text-align:center;">审批意见</td>
               <td width="20%" style="text-align:center;">审批节点</td>
               <td width="15%" style="text-align:center;">审批人</td>
              
             </tr>
             <#if  model.getObject('/model/approved_info_path').getChilds()??>
		     <#list  model.getObject("/model/approved_info_path").getChilds() as approved_info_rec>
		     <#if (payment_req_rec.getString('payment_req_id'))==(approved_info_rec.getString('payment_req_id'))> 
		      <tr>
		       <td >${approved_info_rec.getString('create_date_fmt')!''}</td>
               <td >${approved_info_rec.getString('action_type_desc')!''}</td>
               <td >${approved_info_rec.getString('comment_text')!''}</td>
               <td >${approved_info_rec.getString('node_desc')!''}</td>
               <td >${approved_info_rec.getString('approver')!''}</td>
             </tr>  
		      </#if>
		     </#list>
		     </#if>
		     </table>
		</#list>
		</#if>

		 ]]></a:freeMarker>
        <script><![CDATA[
            window.onload = window.print();
        ]]></script>
    </a:view>
</a:screen>
