<?xml version="1.0" encoding="UTF-8"?>
<a:screen xmlns:a="http://www.aurora-framework.org/application" xmlns:s="aurora.plugin.script" customizationEnabled="true" dynamiccreateenabled="true" trace="true">
    <a:init-procedure><![CDATA[
    ]]></a:init-procedure>
    <a:view>
        <a:link id="con660_recalc_link" model="cont.CON660.recalc_con_redemption" modelaction="execute"/>
        <script><![CDATA[
        
           window['${/parameter/@layout_code}_user_button1_layout_dynamic_click'] = function() {
                var ds_id = get_dsid_by_basetable(window['${/parameter/@layout_code}_layoutDataSetList'], 'con_redemption_certificate');
                var record = $(ds_id).getAt(0);
                    Aurora.Masker.mask(Ext.getBody());
                    Aurora.request({
                        url: $('con660_recalc_link').getUrl(),
                        para: {batch_id:record.get('batch_id')},
                        success: function(res) {
                            Aurora.Masker.unmask(Ext.getBody());
                            $(ds_id).query();
                        },
                        failure: function() {
                            Aurora.Masker.unmask(Ext.getBody());
                        },
                        error: function() {
                            Aurora.Masker.unmask(Ext.getBody());
                        },
                        scope: this
                    });
            };
           ]]></script>
        <a:screen-include screen="modules/cont/CON500/con_contract_get_layout_code.screen"/>
    </a:view>
</a:screen>
