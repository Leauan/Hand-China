<?xml version="1.0" encoding="UTF-8"?>
<a:service xmlns:s="aurora.plugin.script" xmlns:dr="aurora.plugin.excelreport" xmlns:mail="aurora.plugin.mail" xmlns:msg="aurora.application.features.msg" xmlns:t="uncertain.composite.transform" xmlns:p="uncertain.proc" xmlns:a="http://www.aurora-framework.org/application" xmlns:excel="aurora.application.task.excel" trace="true">
    <a:init-procedure>
        <s:server-script><![CDATA[
            //importPackage(Packages.aurora.plugin.mail);
            //importPackage(Packages.uncertain.proc);
            //importPackage(Packages.aurora.plugin.script.scriptobject);
            importPackage(Packages.hl.mail);
            
            try {
                //var sm = new SendMail($instance('uncertain.ocm.IObjectRegistry'));
                var mb = new MailBean();
                //MailBean mb = new MailBean();
                mb.setHost("partner.outlook.cn"); // 设置SMTP主机(163)，若用126，则设为：smtp.126.com
                mb.setUsername("cf_system@hongling.sh.cn"); // 设置发件人邮箱的用户名
                mb.setPassword("HLLmail123"); // 设置发件人邮箱的密码，需将*号改成正确的密码
                mb.setFrom("cf_system@hongling.sh.cn"); // 设置发件人的邮箱
                mb.setTo("yu.zhang07@hand-china.com"); // 设置收件人的邮箱
                mb.setSubject("hand test"); // 设置邮件的主题
                mb.setContent("hello"); // 设置邮件的正文
                var sm = new SendMail();
                sm.sendMail(mb);
                //var procedureRunner = ScriptUtil.getProcedureRunner();
                // 收件人
                //sm.setTto('229548448@qq.com');
                //邮件主题
                //sm.setTitle('测试');
                // 邮件内容
                //sm.setContent('测试邮件发送');
                //发送邮件
                //sm.run(procedureRunner);
                //备份邮件列表
            
            } catch (e) {
                raise_app_error(e);
            }
        ]]></s:server-script>
    </a:init-procedure>
    <a:service-output/>
</a:service>
